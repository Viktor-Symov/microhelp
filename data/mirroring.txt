=========================================
=== Справка по Mirroring.
=== Зеркалирование трафика.
=========================================

Основные требования к полной видимости реальной сети:
 - Любое активное устройство при работе с Ethernet-кадром изменяет его состояние.
 - Важно, чтобы все изменения при применении технологии/устройства зеркалирования трафика были линейными.
   Если смещение кадра составляло 5 мс, то все кадры должны иметь одинаковое смещение в 5 мс, если же нет, то устройство вмешивается в работу мониторинга в реальном времени.

Прежде чем развёртывать технологию доступа к трафику необходимо:
 - Протестировать несколько технологий зеркалирования, чтобы убедиться, что вы получаете те данные, которые действительно нужны и могут обрабатываться инструментами мониторинга
 - Протестировать сеть до и после использования технологии зеркалирования, чтобы сравнить и получить реальную базовую линию воздействия способа зеркалирования на кадры
 - Приобретать и внедрять только качественное оборудование от известных вендоров
 - Понимать юридическую ответсвенность. Любые данные, полученные с помощью технологий зеркалирования, могут быть оспорены как в гражданских, так и в уголовных делах, возбуждаемых по результатам расследований сетевых инцидентов (Network Forensic). При использовании собранных данных в качестве доказательства их неправомерного использования или в ситуациях законного захвата, сетевой TAP — ваш лучший союзник. TAP предоставляет доказательства без шанса что-либо изменить и с твердой временной привязкой. Это криминалистически надёжные данные/доказательства, которые являются обязательными для судебных или внутренних разбирательств в компании.

TAP (Test Access Point) — это простое устройство, которое напрямую подключается в разрыв кабельной инфраструктуры сети. TAP устанавливается между двумя сетевыми устройствами, и все данные информационного обмена проходят через него. Используя внутренний физический (оптический) или логический (электрический) делитель, сетевой TAP ответвляет копию данных для мониторинга не изменяя исходные данные. Большинство TAP отдельно копируют потоки передачи от устройств A и B, отправляя их в отдельные порты мониторинга (TxA и TxB).
SPAN (Switched Port Analyzer) — это программная функция, встроенная в коммутатор или маршрутизатор, которая создает копию выбранных пакетов, проходящих через устройство, и отправляет их на указанный SPAN-порт. Используя программное обеспечение, администратор может получать информацию о трафике.

Сравнение TAP и SPAN:
1. TAP ответвители сетевого трафика:
 - TAP создают полную 100% копию двунаправленного сетевого трафика, обеспечивая максимальную точность мониторинга сети;
 - TAP не изменяют временные соотношения между кадрами, интервалом и временем отклика, что особенно важно при анализе VoIP и Triple Play, включая анализ FDX;
 - TAP не вносят дополнительного джиттера или искажения, что важно при анализе VoIP/видео;
 - TAP пропускают весь трафик: IPv4 или IPv6, пакеты с ошибками, короткие или большие кадры, неправильные кадры CRC, межкадровый интервал не отбрасывается и не изменяется, любые пакеты не отбрасываются независимо от полосы пропускания;
 - TAP отказоустойчивы;
 - Правовые нормы или корпоративное соответствие иногда требуют, чтобы весь трафик для определенного сегмента контролировался. Это можно гарантировать только с помощью TAP;
 - TAP не являются адресными сетевыми устройствами, поэтому не могут быть взломаны;
 - TAP не нужно настраивать и обновлять, получение всех данных гарантировано и экономит время персонала. Просто подключите и контролируйте 100% трафика;

2. SPAN-порт коммутатора:
 - При использовании SPAN создаются дублирующиеся пакеты данных, что снижает эффективность инструментов мониторинга;
 - SPAN может легко переподписаться, отбрасывая пакеты, также наблюдаются потери пакетов в случае перегрузки портов или в случае наличия в них ошибок. В результате «некорректной работы» сетевой инженер упускает из вида часть пользовательского трафика, что не позволяет выявить серьезные ошибки в работе сети, а специалист по информационной безопасности может упустить вирусный трафик или атаку злоумышленника;
 - Данные 1 уровня, повреждённые и некорректные пакеты, неправильный CRC, межкадровый интервал и другие нестандартные данные не пересылаются на SPAN- порты. Следовательно, SPAN не подходит для мониторинга, захвата и анализа протокола реального времени (RTP), особенно в современных стратегиях оценки среднего значения качества голоса или видео (MOS) и качества восприятия в целом (QoE);
 - Теги VLAN не всегда передаются через SPAN-порт, и это зависит от настроек. Поэтому это может привести к обнаружению ложных проблем и затруднению поиска проблем VLAN
 - SPAN-порты предоставляют только обобщенные данные;
 - SPAN-порты изменяют временные метки пакетов;
 - Доказано, что SPAN-порты можно взломать (поэтому они могут представлять угрозу безопасности);
 - SPAN-порт имеет самый низкий приоритет на коммутаторе, когда дело доходит до выбора между основным трафиком и трафиком SPAN;
 - SPAN-порты требуют программирования через интерфейс командной строки и могут быть неправильно настроены, что приводит образованию слепых зон для мониторинга и сбоям;
 - В некоторых странах SPAN не соответствует требованиям закона для случаев законного перехвата;
 - Количество SPAN-портов в коммутаторе ограничено по cравнению с количеством, необходимым для мониторинга. Разным специалистам требуется копия трафика для решения своих задач: обеспечение безопасности, контент фильтрации, обнаружения вторжения, диагностики и устранения проблем;

Другие понятия:
 - NTA (Network Traffic Analysis) - анализтор сетевого трафика;
 - IPS(Intrusion Prevention System) - система предотвращения вторжений;
 - IDS (Intrusion Detection System) – система обнаружения вторжений;
 - NPB(Network Packet Broker) - сетевой брокер, система сбора и обработки копий сетевого трафика;


=========================================
=== Основные понятия по Firewall.
=========================================

Stateless firewall:
Проверяет каждый пакет по отдельности: IP, порт, протокол. Не хранит контекст сессии и не знает, был ли этот пакет частью установившегося соединения. Из‑за этого простые правила фильтрации проходят быстро и почти без нагрузки на CPU, но вот сложные атаки типо спуфинга, повторных пакетов или фрагментации TCP легко обойти.

Stateful firewall:
Сохраняет данные о соединениях: отслеживает TCP handshake, UDP «потоки», NAT‑таблицы и связи между пакетами. Позволяет блочить аномалии внутри сессий, защищать от повторной передачи старых пакетов и сложных атак MITM. Такой firewall анализирует контекст и порядок пакетов, а значит, нагрузка выше, зато уровень безопасности заметно выше.
=========================================
=== Справка по Nmap.
=== инструмент с открытым исходным кодом, для обнаружения хостов и проверки портов.
=========================================

1. Использование Nmap
    $ nmap [Options] [Target...]

2. Рекомендуется запускать через с административными привилегиями sudo
   (включает опцию скрытного сканирования -sS)
    $ sudo nmap 192.168.1.1

3. Быстрое сканирование
    $ nmap -F 192.168.1.1

4. Экспресс-сканирование всех открытых портов в сети
    $ nmap -T5 192.168.1.0/24

5. Для подробного вывода запускать с помощью -v или -vv
    $ nmap -vv 192.168.1.1

6. Запуск сканирования IPv6 хоста
    $ nmap -6 fd12:3456:789a:1::1

7. Указание целевых хостов
    $ nmap 192.168.1.1 server1.home.local
    $ nmap 192.168.1.0/24
    $ nmap 192.168.1-2.1
    $ nmap 192.168.1,2,2.1
    $ nmap 1.8-1.10,11,12.0/28 192.168.2-3.100,101
   Опция --exclude исключает адреса из сканирования
    $ nmap 10.8-10.10,11,12.0/28 --exclude 10.10.12.12
   Проверка преречисления адресов без фактического сканирования
    $ nmap -sL 10.8-10.10,11,12.0/28 192.168.1-2.100,101
   Получить список хостов из заранее подготовленного файла
    $ nmap -iL /tmp/scanlist.txt
    $ nmap -iL /tmp/scanlist.txt --excludefile /tmp/exclude.txt
   Отключение разрешения DNS-имен
    $ nmap -n 192.168.10.0/16

8. Ping сканирование
    $ sudo nmap -sn 192.168.10.0/24
    $ nmap -PO 192.168.1.1

9. Указание портов
   Cканировать все порты с 1 по 65535, параметр -p-
    $ nmap -p- 192.168.10.121
   Каждый порт может находиться в одном из следующих состояний:
    - open - программа, запущенная на порту, отвечает на запрос;
    - closed - на порту не работает ни одна программа, и хост отвечает на запросы;
    - filtered - Хост не отвечает на запрос;
   Cканировать только порт 443
    $ nmap -p 443 192.168.10.121
   Указать более одного порта:
    $ nmap -p 80,443 192.168.1.1
    $ nmap -p 1-1024 192.168.1.1
    $ nmap -p 1-1024,8080,9000 192.168.1.1
    $ nmap -p ssh 192.168.1.1

10. Сканируем указанный порт по TCP
    $ nmap -p T:80 192.168.1.1

11. Сканируем указанный порт по UDP
    $ nmap -p U:53 192.168.1.1

12. Комбинируем опции сканирования
    $ nmap -p U:53,111,137,T:21-25,80,139,8080 192.168.1.1
    $ nmap -p U:53,111,137,T:21-25,80,139,8080 server1.home.local
    $ nmap -v -sU -sT -p U:53,111,137,T:21-25,80,139,8080 192.168.1.254

13. Сканирование хоста на предмет UDP-сервисов
   Утилита предлагает обнаружение служб, ипользующих UDP-подключение.Опция -sU
    $ nmap -sU server1.home.local
    $ nmap -sU 192.168.1.1

14. Скрытное сканирование с TCP SYN
   Полуоткрытое сканирование (TCP SYN) без установки полноценного соединения. Опция -sS
    $ nmap -sS 192.168.1.1

15. Сканирование с помощью пинга TCP ACK (PA) и TCP Syn (PS)
   Брандмауэр может отклонять все запросы ICMP. В таком случае можно попробовать выполнить сканирование так
    $ nmap -PS 192.168.1.1
    $ nmap -PS 80,21,443 192.168.1.1
    $ nmap -PA 192.168.1.1
    $ nmap -PA 80,21,200-512 192.168.1.1

16. Сканирование хоста UDP-пингом
   Для обхода межсетевых экранов с помощью UDP-пинга. Опция -PU
    $ nmap -PU 192.168.1.1
    $ nmap -PU 2000.2001 192.168.1.1

17. Определение ОС, служб и версий
    $ nmap -O scanme.nmap.org

18. Сканируем версию ОС
    $ nmap -A 192.168.1.254
    $ nmap -v -A 192.168.1.1

19. Указываем ложный MAC-адрес (спуфинг MAC)
    $ nmap --spoof-mac MAC-ADDRESS-HERE 192.168.1.1
    $ nmap --spoof-mac MAC-ADDRESS-HERE 192.168.1.1
   Дополнительные опции спуфинга
    $ nmap -v -sT -PN --spoof-mac MAC-ADDRESS-HERE 192.168.1.1
   Использование случайного MAC-адреса
   «0» означает, что Nmap выберет совершенно случайный MAC-адрес:
    $ nmap -v -sT -PN --spoof-mac 0 192.168.1.1

20. Вывод Nmap в разных форматах
   В обычном формате
    $ nmap -sU -p 1-1024 192.168.10.121 -oN output.txt
   В формате XML
    $ nmap -sU -p 1-1024 192.168.10.121 -oX output.xml
   В формате для удобного анализа утилитами Unix, таких как grep, awk и cut
    $ nmap -sU -p 1-1024 192.168.10.121 -oG output

21. Механизм сценариев Nmap
    $ nmap -sV --script http-malware-host scanme.nmap.org

22. Вывод всех отправленных/полученных пакетов
    $ nmap --packet-trace 192.168.1.1


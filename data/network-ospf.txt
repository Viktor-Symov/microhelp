OSPF

Open Shortest Path First (OSPF) — это открытый протокол маршрутизации, относящийся к классу протоколов внутреннего шлюза (IGP), использующий алгоритм состояния каналов (link-state). Разработан как альтернатива протоколу RIP и стандартизирован в RFC 2328 (OSPFv2) для IPv4 и RFC 5340 (OSPFv3) для IPv6.
OSPF основан на технологии поиска кратчайшего пути SPF (Shortest Path First), которая применяет алгоритм Дейкстры для расчёта оптимальных маршрутов. В отличие от дистанционно-векторных протоколов, OSPF обладает полной картиной сети, что позволяет ему быстрее сходиться и эффективнее использовать полосу пропускания.



Ключевые характеристики OSPF:
1. Быстрая сходимость — минимальное время реакции на изменения в сетевой топологии.
2. Иерархическая структура — разделение сети на области (areas) для увеличения масштабируемости, снижения нагрузки на процессоры маршрутизаторов и служебный трафик в сети.
3. Экономное использование полосы пропускания — отправка только изменений состояния связей.
4. Поддержка VLSM и CIDR — эффективное использование IP-адресного пространства.
5. Аутентификация — защита обмена маршрутной информации.



Преимущество OSPF:
1. Каждый маршрутизатор в домене маршрутизации имеет точную информацию о топологии сети передачи данных, следовательно, он может гарантировать, что в таблицу маршрутизации будут внесены истинные и оптимальные маршруты до сетей получателей.
2. преимущество следует из первого. Оно заключается в том, что если маршрутизатор имеет точную информацию о топологии сети передачи данных в домене маршрутизации, он может самостоятельно, не прибегая к механизму рассылки запросов соседним маршрутизаторам, о возможных альтернативных маршрутах, вносить изменения в таблицу маршрутизации, после того как, он обнаружил недоступность того или иного маршрута.



Установка соседства (adjacency) в OSPF — ключевой этап, без которого обмен маршрутной информацией невозможен.
Соседство — соединение между двумя маршрутизаторами по протоколу OSPF, позволяющее им напрямую обмениваться LSA (Link‑State Advertisements) и синхронизировать LSDB (Link‑State Database).

Условия установления соседства:
1. Маска подсети — должна быть идентичной.
2. Идентификаторы маршрутизаторов (Router-id) должны отличаться.
3. Идентификатор зоны (Area ID) — маршрутизаторы должны находиться в одной зоне.
4. Тип зоны — например, оба не могут быть в разных типах (Stub и NSSA).
5. Параметры аутентификации — метод и ключ (если аутентификация включена).
6. Интервалы таймеров:
    - Hello Interval — как часто отправляются Hello‑пакеты (по умолчанию: 10 с для broadcast, 30 с для NBMA).
    - Router Dead Interval — время ожидания ответа перед объявлением соседа «мёртвым» (по умолчанию: 4 × Hello Interval).
7. MTU — максимальный размер пакета (некоторые реализации проверяют совпадение).
8. Флаг E (External) в Hello‑пакетах — должен совпадать (определяет, могут ли маршрутизаторы принимать внешние маршруты).



Таймеры:
1. hello-interval — периодичность отправки Hello-пакетов (по умолчанию 10 секунд).
2. dead-interval — время, после которого сосед считается недоступным (по умолчанию 40 секунд).
3. timers throttle spf — параметры задержки для алгоритма SPF (начальная задержка, максимальная задержка, время удержания).



Роли маршрутизаторов в OSPF:
1. Internal Router — все интерфейсы в одной области.
2. Area Border Router (ABR) — соединяет две или более областей.
3. Backbone Router — имеет хотя бы один интерфейс в Area 0.
4. Autonomous System Boundary Router (ASBR) — соединяет OSPF с другими протоколами маршрутизации.



Этапы установления соседства:

1. Down
Начальное состояние. Маршрутизатор ещё не обнаружил соседа. Отправляет Hello‑пакеты в сегмент.

2. Init
Маршрутизатор получил Hello‑пакет от соседа, но в этом пакете своего Router ID ещё нет. Значит, сосед пока не «видит» его в ответ.

3. 2‑Way
В полученном Hello‑пакете от соседа обнаружен собственный Router ID.
Для сетей типа broadcast и NBMA на этом этапе выбираются DR (Designated Router) и BDR (Backup Designated Router).
В point‑to‑point сетях переход к следующему этапу происходит сразу.

4. ExStart
Определение master/slave для обмена DBD (Database Description) пакетами. Маршрутизатор с большим Router ID становится master и инициирует обмен.

5. Exchange
Обмен DBD‑пакетами — краткое описание LSDB каждого маршрутизатора. Каждый узнает, какие LSA есть у соседа.

6. Loading
Запрос недостающих LSA через LSR (Link State Request).
Получение полных LSA через LSU (Link State Update).
Подтверждение через LSAck (Link State Acknowledgment).

7.Full
LSDB синхронизированы.
Соседство установлено, маршрутизаторы готовы обмениваться маршрутной информацией.



Роль DR и BDR:
В сетях с множественным доступом (например, Ethernet) выбираются:
 - DR — центральный узел для обмена LSA. Все маршрутизаторы устанавливают соседство только с DR и BDR.
 - BDR — резервный DR. Перенимает роль, если DR выходит из строя.

Как выбираются DR/BDR:
 - По приоритету интерфейса (0–255; по умолчанию 1). Приоритет 0 исключает маршрутизатор из выборов.
 - Если приоритеты равны — по наибольшему Router ID.



Типы пакетов OSPF:
 - Hello — обнаружение соседей, поддержание соседства.
 - DBD (Database Description) — краткое описание LSDB.
 - LSR (Link State Request) — запрос конкретных LSA.
 - LSU (Link State Update) — передача полных LSA.
 - LSAck — подтверждение получения LSU.



Типы LSA (Link State Advertisement):

1. LSA Type 1: Router LSA
Источник: все маршрутизаторы в зоне.
Область распространения: только внутри своей зоны (не выходит за её пределы).
Содержание: описывает собственные интерфейсы маршрутизатора, их состояние и стоимость связей, а также список соседей в той же зоне.
Ключевая особенность: основа для построения топологии внутри зоны.

2. LSA Type 2: Network LSA
Источник: Designated Router (DR) в сетях с множественным доступом (например, Ethernet).
Область распространения: внутри зоны.
Содержание: список всех маршрутизаторов, подключённых к сегменту, где работает DR.
Ключевая особенность: позволяет построить полную карту топологии сегмента.

3. LSA Type 3: Summary LSA
Источник: Area Border Router (ABR).
Область распространения: между зонами (передаётся в другие зоны).
Содержание: суммарная информация о сетях в соседней зоне (маршруты внутри зоны, агрегированные ABR).
Ключевая особенность: обеспечивает межзоновую маршрутизацию.

5. LSA Type 5: AS External LSA
Источник: ASBR.
Область распространения: по всей автономной системе (AS).
Содержание: описывает внешние маршруты, импортированные в OSPF (например, из BGP).
Ключевая особенность: единственный тип LSA, несущий информацию о внешних сетях.
Каждый ASBR генерирует по одной LSA на каждый префикс.
 - Тип 1: E1 - суммарная метрика инсталлированного префикса и стоимость пути следования в OSPF домене (исходящих интерфейсов).
 - Тип 2: E2 - метрика которая не изменяется по пути следования в OSPF домене.

4. LSA Type 4: ASBR Summary LSA
Источник: ABR.
Область распространения: в другие зоны (кроме той, где находится ASBR).
Содержание: информирует о наличии Autonomous System Border Router (ASBR) в другой зоне (указывает его Router ID).
Ключевая особенность: есть проблема, маршрутизаторы могут не знать, как добраться до ASBR находящегося в другой зоне. Необходим для корректной маршрутизации к внешним сетям через ASBR.
ABR распространяет информацию о наличии ASBR в сети, по одной LSA на каждый ASBR.

6. LSA Type 6: Group Membership LSA
Назначение: используется в Multicast OSPF (MOSPF) для описания групп рассылки.
Статус: редко применяется (MOSPF не поддерживается большинством вендеров, включая Cisco).

7. LSA Type 7: NSSA External LSA
Источник: ASBR в зоне типа Not-So-Stubby Area (NSSA).
Область распространения: только в пределах NSSA.
Содержание: аналогичен Type 5, но предназначен для NSSA (внешние маршруты).
Ключевая особенность: преобразуется в Type 5 на ABR при выходе из NSSA.

8. LSA Type 8: External Attributes LSA (OSPFv2) / Link-Local LSA (OSPFv3)
OSPFv2: передаёт атрибуты BGP (например, MED) через OSPF (редко используется).
OSPFv3: описывает локальные ссылки для IPv6.
Статус: ограниченная поддержка на оборудовании.

9. LSA Type 9: Link Scope Opaque LSA (OSPFv2) / Intra-Area Prefix LSA (OSPFv3)
OSPFv2: используется для произвольных данных в пределах ссылки (например, для расширений).
OSPFv3: передаёт префиксы IPv6 внутри зоны.
Ключевая особенность: гибкий механизм для дополнительных данных.

10. LSA Type 10: Area Scope Opaque LSA
Область распространения: внутри зоны.
Назначение: передача произвольных данных для расширений OSPF (например, для Traffic Engineering в MPLS).
Ключевая особенность: не обрабатывается маршрутизаторами, не поддерживающими расширение.

11. LSA Type 11: AS Scope Opaque LSA
Область распространения: по всей AS.
Назначение: аналогичные Type 10, но для данных, актуальных во всей автономной системе.
Ключевая особенность: используется в специализированных сценариях (например, для MPLS TE).

Важные замечания:
Типы 1–5 — основные, встречаются в большинстве сетей.
Типы 6–11 — специализированные, применяются в узких сценариях (Multicast, IPv6, расширения OSPF).
NSSA (Type 7) позволяет использовать ASBR в «почти тупиковой» зоне, преобразуя внешние маршруты в Type 7 внутри зоны и в Type 5 за её пределами.
Opaque LSA (Types 9–11) предназначены для передачи пользовательских данных и расширений протокола.



Основные типы зон (area).
Каждая зона решает свои задачи по ограничению объёма маршрутной информации и оптимизации нагрузки на маршрутизаторы.

1. Магистральная зона (Backbone Area, Area 0, 0.0.0.0)
Роль: ядро сети OSPF, связующее звено между всеми остальными зонами.
Особенности:
 - Все межзонные маршруты проходят через Area 0.
 - Должна быть непрерывной (без «разрывов»).
 - Маршрутизаторы с интерфейсом в Area 0 называются Backbone Router.
 - LSA: принимает все типы (1–5).

2. Стандартная зона (Normal/Standard Area)
Роль: зона по умолчанию; полная маршрутизация внутри и между зонами.
Особенности:
 - Принимает обновления каналов, суммарные (Type 3) и внешние (Type 5) маршруты.
 - Нет ограничений на типы LSA.
Применение: стандартные сегменты сети, когда нужна полная топологическая информация.

3. Тупиковая зона (Stub Area)
Роль: снижение нагрузки на маршрутизаторы за счёт фильтрации внешних маршрутов.
Особенности:
 - Принимает LSA Type 3 (Summary).
 - Не принимает LSA Type 4 (ASBR Summary) и Type 5 (External).
 - ABR добавляет LSA Type 3 маршрут по умолчанию (0.0.0.0/0) для трафика вне OSPF-домена.
 - Внутри зоны циркулируют только LSA Type 1, 2 и 3.
Ограничения: в Stub Area не может находиться ASBR.

4. Полностью тупиковая зона (Totally Stubby Area, TSA)
Роль: максимальное сокращение LSDB за счёт фильтрации межзонных и внешних маршрутов.
Особенности:
 - Блокирует LSA Type 3 (межзонные), Type 4 и Type 5.
 - ABR анонсирует только маршрут по умолчанию.
 - Внутри зоны — только LSA Type 1 и 2.
Примечание: термин Totally Stubby введён Cisco; в стандарте OSPF такого типа нет.

5. NSSA (Not‑So‑Stubby Area)
Роль: гибридный вариант для зон, где нужен ASBR, но без полного потока внешних маршрутов.
Особенности:
 - Разрешает ASBR внутри зоны (генерирует LSA Type 7 для внешних маршрутов).
 - ABR преобразует Type 7 в Type 5 при выходе из NSSA.
 - Не принимает внешние маршруты из других зон (Type 5).
Когда использовать: если в зоне есть маршрутизатор, импортирующий маршруты из другой АС (например, через BGP).

6. Totally NSSA
Роль: комбинация NSSA и Totally Stubby.
Особенности:
 - Блокирует LSA Type 3, 4 и 5.
 - ASBR внутри зоны использует Type 7.
 - ABR анонсирует маршрут по умолчанию.
Примечание: также специфичен для Cisco.

Суммарная информация по типам зон:
╔═══════════════╦═════════════════════════╦═════════════════════════╦═════════════════════════╦═══════════════════════════════╗
║ Тип области   ║ ABR передаёт LSA type 5 ║ ABR передаёт LSA type 3 ║ Позволена редистрибуция ║ Команда конфигурирования      ║
║               ║ в область?              ║ в область?              ║ в тупиковую зону?       ║                               ║
╠═══════════════╬═════════════════════════╬═════════════════════════╬═════════════════════════╬═══════════════════════════════╣
║Stubby         ║ Нет                     ║ Да                      ║ Нет                     ║ area <номер> stub             ║
║Totally stubby ║ Нет                     ║ Нет                     ║ Нет                     ║ area <номер> stub no-summary  ║
║NSSA           ║ Нет                     ║ Да                      ║ Да                      ║ area <номер> nssa             ║
║Totally NSSA   ║ Нет                     ║ Нет                     ║ Да                      ║ area <номер> nssa no-summary  ║
╚═══════════════╩═════════════════════════╩═════════════════════════╩═════════════════════════╩═══════════════════════════════╝

Как выбрать тип зоны?
 - Area 0 — обязательна для мультизонной сети.
 - Standard — если нужна полная информация о топологии.
 - Stub/TSA — для филиалов с низкопроизводительными маршрутизаторами.
 - NSSA — если в зоне есть ASBR, но не хочется перегружать LSDB внешними маршрутами.



Фильтрация маршрутов в OSPF — механизм контроля распространения маршрутной информации между областями (areas) и за пределы автономной системы.
Ключевое ограничение: фильтрация возможна только на пограничных маршрутизаторах — ABR (Area Border Router) и ASBR (Autonomous System Boundary Router).

Основные методы фильтрации:
1. area filter‑list — фильтрация LSA типа 3 (Summary LSA) на ABR.
   Принцип: блокирует анонсирование сетей из одной области в другую.
     area <area‑id> filter-list prefix <prefix‑list‑name> {in | out}
   Параметры:
     in — запрещает попадание указанных сетей в область <area‑id>;
     out — фильтрует сети, исходящие из области <area‑id>.
   Пример:
     area 0 filter-list prefix BLOCK_NETS in
     (блокирует попадание сетей из списка BLOCK_NETS в Area 0).

2. distribute‑list — фильтрация записей в таблице маршрутизации (но не в базе OSPF).
   Принцип: маршрут остаётся в базе OSPF (show ip ospf database), но не попадает в таблицу маршрутизации.
     distribute-list <access‑list | prefix‑list | route‑map> in [interface <type‑number>]
   Важно: работает только с параметром `in`.
   Пример:
     distribute-list prefix FILTER_ROUTES in

3. route‑map — фильтрация на ASBR (для LSA типа 5, внешних маршрутов).
   Принцип: управляет редистрибуцией маршрутов из других доменов (например, EIGRP → OSPF).
   Команда (на ASBR):
     redistribute <protocol> route-map <map‑name>
   Пример (запрет сетей 172.16.101.0/24 и 172.16.102.0/25):
     ip prefix-list BLOCK_EXT seq 5 deny 172.16.101.0/24
     ip prefix-list BLOCK_EXT seq 10 deny 172.16.102.0/25
     ip prefix-list BLOCK_EXT seq 15 permit 0.0.0.0/0 le 32
     route-map FILTER_EXT permit 10
      match ip address prefix-list BLOCK_EXT
     redistribute eigrp 100 route-map FILTER_EXT

Инструменты для условий фильтрации:
- Access Control List (ACL) — фильтрация по IP‑адресам и маскам.
- Prefix‑list — более гибкий аналог ACL с поддержкой диапазонов префиксов (`le`, `ge`).
- Route‑map — сложные условия (совмещение ACL, prefix‑list, метрик и т. д.).

Примеры сценариев:
1. Блокировка сети 10.16.1.0/24 в Area 1:
   ip prefix-list AREA1_FILTER seq 5 deny 10.16.1.0/24
   ip prefix-list AREA1_FILTER seq 10 permit 0.0.0.0/0 le 32
   area 1 filter-list prefix AREA1_FILTER out

2. Фильтрация внешних маршрутов на ASBR:
   route-map BLOCK_EXTERNAL deny 10
    match ip address prefix-list EXTERNAL_BLOCK
   route-map BLOCK_EXTERNAL permit 20
   redistribute bgp 65001 route-map BLOCK_EXTERNAL

3. Исключение маршрута из таблицы маршрутизации (но сохранение в OSPF‑базе):
   ip prefix-list HIDDEN_ROUTE seq 5 permit 192.168.5.0/24
   distribute-list prefix HIDDEN_ROUTE in

Важные нюансы:
- LSA типа 3 (Summary LSA) фильтруются только на ABR.
- LSA типа 5 (External LSA) фильтруются только на ASBR.
- Фильтрация через `distribute‑list -  не удаляет маршрут из базы OSPF — это может усложнить диагностику.
- Для route‑map всегда добавляйте явное permit в конце, иначе все неописанные маршруты будут заблокированы.
- Проверяйте результаты командами:
    show ip route — таблица маршрутизации;
    show ip ospf database — база OSPF;
    show ip prefix-list / show access-lists — проверка списков фильтрации.

Рекомендации:
1. Используйте prefix‑list вместо ACL — они эффективнее и нагляднее.
2. Тестируйте фильтрацию в лабораторной среде перед внедрением.
3. Документируйте правила фильтрации (зачем и какие сетиблокируются).
4. Избегайте избыточной фильтрации — она может нарушить связность сети.



OSPF virtual-link — это логический канал связи между двумя маршрутизаторами OSPF, который позволяет им обеспечить связь с магистральной областью 0 (backbone area) через другие зоны или соединить разорванные части Area 0.
Согласно спецификации OSPF, все области автономной системы должны быть физически подключены к Area 0 (магистральной области). Virtual-link решает следующие сценарии, когда это требование нарушается:
- соединение разорванных областей с Area 0;
- объединение разорванной на части магистральной области (partitioned backbone) через промежуточную область;
- создание резервного пути для области на случай отказа прямых соединений.

Важные ограничения и требования:
1. Транзитная область (через которую проходит virtual-link):
   - должна иметь полную информацию о маршрутах (не быть stub area);
   - не может быть stub, totally stubby, NSSA или totally NSSA областью.

2. Конфигурация с обеих сторон:
   - обе конечные точки virtual-link должны быть настроены симметрично (один и тот же area ID и Router ID соседа);
   - необходимо указать идентификатор транзитной области (transit area ID) и Router ID удалённого маршрутизатора.

3. Ограничения топологии:
   - virtual link не может пересекать более одной транзитной области;
   - наличие нескольких virtual-link между одними и теми же областями может привести к маршрутным петлям.

4. Рекомендации по использованию:
   - рассматривать virtual-link как временное решение, а не как элемент постоянного дизайна сети;
   - по возможности заменять на физические соединения или GRE‑туннели;
   - настраивать аутентификацию и шифрование для защиты трафика OSPF;
   - мониторить производительность и стабильность транзитной области.

Настройка OSPF virtual-link (общий алгоритм):
1. Определите два маршрутизатора‑конечные точки virtual-link и транзитную область.
2. На обоих маршрутизаторах выполните команды конфигурации (пример для Cisco IOS):
router ospf <process-id>
 network <network-address> <wildcard-mask> area <area-id>
 area <transit-area-id> virtual-link <remote-router-id>
   - <process-id> — идентификатор процесса OSPF;
   - <network-address> и <wildcard-mask> — сеть и маска для объявления в OSPF;
   - <area-id> — ID области, к которой принадлежит интерфейс;
   - <transit-area-id> — ID транзитной области;
   - <remote-router-id> — Router ID удалённого маршрутизатора на другом конце virtual link.
3. Задайте стоимость (cost) virtual link (опционально), чтобы влиять на выбор маршрута.
4. Проверьте состояние соседства OSPF командой `show ip ospf neighbor`.

Примеры использования:
 - Соединение несмежной области с Area 0: область 10 разделена на две части, и одна из них не имеет прямого соединения с Area 0. Virtual-link через область 2 обеспечивает связь.
 - Восстановление разорванной Area 0: если магистральная область разорвана на два сегмента, virtual-link через область 3 соединяет их логически.
 - Резервный путь: на случай отказа основного соединения между областью и Area 0, virtual-link через альтернативную область обеспечивает отказоустойчивость.

Альтернативы virtual-link:
 - **GRE‑туннель — создаёт явный туннельный интерфейс, который может быть более предсказуемым и управляемым;
 - Перепроектирование сети — физическое подключение всех областей к Area 0 для устранения необходимости в virtual-link.

Итоги:
OSPF virtual-link — полезный инструмент для решения временных проблем связности в сетях OSPF, но его следует использовать осмотрительно из‑за потенциальных рисков (петли, зависимость от транзитной области). Оптимальная практика — стремиться к топологии с прямым подключением всех областей к Area 0 и применять virtual-link только как временное решение.



Loop-Free Alternate (LFA) в OSPF.
LFA (Loop-Free Alternate) - технология для быстрого переключения с основного маршрута на резервный.
При включении LFA создаётся новая таблица с резервными, маршрутами для быстрого переключения (fast-reroute). Если маршрутизатор детектирует падение локального линка, по которому строился основной маршрут, то в FIB моментально отправляется заранее выбранный резервный маршрут. Пересчёт дерева по алгоритму SPF осуществляется независимо от переключения на резервный маршрут и может происходить как во время переключений, так и после.

Для того чтобы резервный маршрут был добавлен в таблицу быстрого переключения маршрутов, необходимо и достаточно выполнения следующего условия:
D(N,D) < D(N,S) + D(S,D) где: D(x,y) — расстояние между x и y, выраженное в ospf-метрике; N — соседний маршрутизатор, через который ищется резервный путь; D — маршрут назначения; S — источник.

Резервный маршрут может быть только один. Когда на роль резервного маршрута есть несколько претендентов, то работают следующие правила:
 - Выигрывает маршрут с наименьшей метрикой.
 - Если метрики равны, то выбирается маршрут с наименьшим адресом соседнего маршрутизатора.

Если в основной таблице маршрутизации RIB находятся два активных маршрута, т.е. работает ECMP, то таблица для маршрутов быстрого переключения будет пуста.

Резервный маршрут рассчитывается для каждого основного маршрута отдельно (per-prefix LFA). В случае для ECMP альтернативным для каждого основного маршрута будет второй активный маршрут. Поскольку эти маршруты и так находятся в основной таблице маршрутизации, то нет необходимости их помещать в таблицу для быстрого переключения маршрутов.

Включения LFA:
router ospf <process-id>
 fast-reroute keep-all-paths

Выключения LFA на конкретных интерфейсах используется команда:
ip ospf fast-reroute per-prefix candidate disable.

Просмотреть потенциальные резервные маршруты:
show ip route fast-reroute.
show ip route vrf <NAME> fast-reroute
Вывод данной команды аналогичен формату вывода команды show ip route.



Типичные проблемы и диагностика OSPF:
Соседство не поднимается до Full:
 - Несовпадение Area ID, аутентификации или масок.
 - Разные значения Hello/Dead Interval.
 - Блокировка пакетов OSPF (firewall, ACL).

Соседство поднимается до 2-WAY:
 - Не совпадение MTU.
 - в шаринг сенгменте, DROTHER поднимают соседство между собой только до 2-WAY.

Отсутствие DR/BDR:
 - Все приоритеты 0.
 - Некорректная настройка сети (например, point‑to‑point вместо broadcast).

Частые пересчёты SPF:
 - Нестабильность соседства (проверьте физические линки, таймеры).



Оптимизации:
1. Фильтрация и суммаризация маршрутов
Суммаризация маршрутов значительно уменьшает размер таблицы маршрутизации и LSDB:
Включение суммаризации на ABR для внутренних маршрутов:
Router(config-router)# area 1 range 192.168.0.0 255.255.0.0
Включение суммаризации на ASBR для внешних маршрутов:
Router(config-router)# summary-address 10.0.0.0 255.0.0.0

2. Настройка приоритетов для выбора DR/BDR
В сетях с множественным доступом OSPF выбирает выделенный (DR) и резервный выделенный (BDR) маршрутизаторы для снижения количества соседских отношений:
Установка приоритета OSPF (Cisco):
Router(config-if)# ip ospf priority 100
Маршрутизаторы с более высокими значениями приоритета имеют больше шансов стать DR. Значение 0 исключает маршрутизатор из процесса выбора.

3. Оптимизация LSA
Ограничение генерации и обработки LSA снижает нагрузку на маршрутизаторы:
Настройка задержки генерации LSA (Cisco):
Router(config-router)# timers throttle lsa all 50 200 5000
Настройка LSA групп (Cisco):
Router(config-router)# timers pacing lsa-group 60

4. Использование BFD для быстрого обнаружения отказов
Bidirectional Forwarding Detection (BFD) позволяет OSPF быстрее обнаруживать отказы каналов:
Включение BFD на Cisco:
Router(config)# bfd interval 100 min_rx 100 multiplier 3
Router(config-if)# ip ospf bfd

5. Настройка ECMP (Equal-Cost Multi-Path)
OSPF поддерживает распределение нагрузки по равноценным маршрутам:
Настройка количества путей для ECMP (Cisco):
Router(config-router)# maximum-paths 8
